<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Completo - Dante Propiedades</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }
        
        .container { 
            max-width: 1400px; 
            margin: 0 auto; 
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
        }
        
        h1 { 
            color: #232deb; 
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.1em;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #232deb;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #232deb;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary { background: #232deb; color: white; }
        .btn-primary:hover { background: #1a1db4; transform: translateY(-2px); }
        
        .btn-success { background: #25d366; color: white; }
        .btn-success:hover { background: #1da851; transform: translateY(-2px); }
        
        .btn-warning { background: #ffc107; color: #333; }
        .btn-warning:hover { background: #e0a800; transform: translateY(-2px); }
        
        .btn-danger { background: #dc3545; color: white; }
        .btn-danger:hover { background: #c82333; transform: translateY(-2px); }
        
        .search-box {
            flex-grow: 1;
            max-width: 400px;
        }
        
        .search-box input {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 16px;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: #232deb;
        }
        
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }
        
        th {
            background: #232deb;
            color: white;
            padding: 15px;
            text-align: left;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .email-cell { 
            max-width: 200px; 
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .message-cell { 
            max-width: 300px; 
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .message-cell:hover {
            white-space: normal;
            overflow: visible;
            position: relative;
            z-index: 5;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        .date-cell {
            white-space: nowrap;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .page-btn {
            padding: 8px 12px;
            border: 1px solid #dee2e6;
            background: white;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .page-btn.active {
            background: #232deb;
            color: white;
            border-color: #232deb;
        }
        
        .page-btn:hover:not(.active) {
            background: #f8f9fa;
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 1.2em;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }
        
        .detail-item {
            margin-bottom: 15px;
        }
        
        .detail-label {
            font-weight: bold;
            color: #232deb;
            margin-bottom: 5px;
        }
        
        .detail-value {
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 3px solid #232deb;
        }
        
        @media (max-width: 768px) {
            .container { padding: 15px; }
            h1 { font-size: 2em; }
            .controls { flex-direction: column; }
            .search-box { max-width: 100%; }
            th, td { padding: 8px 10px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Panel de Administraci√≥n</h1>
            <p class="subtitle">Dante Propiedades - Todas las consultas registradas</p>
        </div>
        
        <div class="stats-grid" id="statsContainer"></div>
        
        <div class="controls">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Buscar por nombre, email, tel√©fono o mensaje...">
            </div>
            <button class="btn btn-primary" onclick="refreshData()">
                üîÑ Actualizar
            </button>
            <button class="btn btn-success" onclick="exportToCSV()">
                üì• Exportar CSV
            </button>
            <button class="btn btn-warning" onclick="exportToExcel()">
                üìä Exportar Excel
            </button>
            <button class="btn btn-danger" onclick="showClearModal()">
                üóëÔ∏è Limpiar Todo
            </button>
        </div>
        
        <div class="table-container">
            <div id="loading">Cargando datos...</div>
            <table id="dataTable" style="display: none;">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Fecha</th>
                        <th>Hora</th>
                        <th>Nombre</th>
                        <th>Email</th>
                        <th>Tel√©fono</th>
                        <th>Inter√©s</th>
                        <th>Presupuesto</th>
                        <th>Mensaje</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
        
        <div id="pagination" class="pagination"></div>
        
        <div id="noData" class="no-data" style="display: none;">
            No hay datos guardados a√∫n.
        </div>
    </div>
    
    <!-- Modal de Detalles -->
    <div class="modal" id="detailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Detalles de la Consulta</h2>
                <button class="close-modal" onclick="closeModal()">√ó</button>
            </div>
            <div id="modalContent"></div>
        </div>
    </div>
    
    <!-- Modal de Confirmaci√≥n -->
    <div class="modal" id="confirmModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Confirmar Acci√≥n</h2>
                <button class="close-modal" onclick="closeConfirmModal()">√ó</button>
            </div>
            <div id="confirmMessage" style="margin-bottom: 20px;"></div>
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button class="btn btn-warning" onclick="closeConfirmModal()">Cancelar</button>
                <button class="btn btn-danger" id="confirmButton">Confirmar</button>
            </div>
        </div>
    </div>

    <script>
        let allData = [];
        let filteredData = [];
        let currentPage = 1;
        const itemsPerPage = 20;
        
        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            setupSearch();
        });
        
        // Cargar datos desde localStorage
        function loadData() {
            console.log('üìÇ Cargando datos desde localStorage...');
            
            // Cargar datos principales
            const mainData = JSON.parse(localStorage.getItem('consultas_dante_propiedades') || '[]');
            console.log(`üìä Datos principales: ${mainData.length} registros`);
            
            // Cargar backup
            const backupData = JSON.parse(localStorage.getItem('backup_consultas_dante') || '[]');
            console.log(`üìä Datos de backup: ${backupData.length} registros`);
            
            // Combinar datos (eliminar duplicados por ID o timestamp)
            allData = [...mainData, ...backupData];
            
            // Eliminar duplicados (basado en nombre, email, mensaje y timestamp similar)
            allData = removeDuplicates(allData);
            
            // Ordenar por fecha m√°s reciente primero
            allData.sort((a, b) => {
                const dateA = a.timestamp ? new Date(a.timestamp) : new Date(0);
                const dateB = b.timestamp ? new Date(b.timestamp) : new Date(0);
                return dateB - dateA;
            });
            
            console.log(`üìä Total de registros √∫nicos: ${allData.length}`);
            
            // Actualizar estad√≠sticas
            updateStats();
            
            // Mostrar datos
            filteredData = [...allData];
            renderTable();
            renderPagination();
            
            // Ocultar loading, mostrar tabla si hay datos
            document.getElementById('loading').style.display = 'none';
            if (allData.length > 0) {
                document.getElementById('dataTable').style.display = 'table';
                document.getElementById('noData').style.display = 'none';
            } else {
                document.getElementById('noData').style.display = 'block';
            }
        }
        
        // Eliminar duplicados
        function removeDuplicates(data) {
            const seen = new Set();
            return data.filter(item => {
                // Crear una clave √∫nica basada en varios campos
                const key = `${item.nombre}-${item.email}-${item.mensaje?.substring(0, 50)}-${item.timestamp?.substring(0, 16)}`;
                if (seen.has(key)) {
                    return false;
                }
                seen.add(key);
                return true;
            });
        }
        
        // Actualizar estad√≠sticas
        function updateStats() {
            const statsContainer = document.getElementById('statsContainer');
            
            if (allData.length === 0) {
                statsContainer.innerHTML = `
                    <div class="stat-card">
                        <div class="stat-number">0</div>
                        <div class="stat-label">Consultas Totales</div>
                    </div>
                `;
                return;
            }
            
            // Calcular estad√≠sticas
            const today = new Date().toLocaleDateString('es-AR');
            const todayCount = allData.filter(item => item.fecha === today).length;
            
            const interests = {};
            allData.forEach(item => {
                const interes = item.interes || 'No especificado';
                interests[interes] = (interests[interes] || 0) + 1;
            });
            
            const topInterest = Object.entries(interests).sort((a, b) => b[1] - a[1])[0];
            
            const emails = new Set(allData.map(item => item.email).filter(email => email));
            const uniqueEmails = emails.size;
            
            statsContainer.innerHTML = `
                <div class="stat-card">
                    <div class="stat-number">${allData.length}</div>
                    <div class="stat-label">Consultas Totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${todayCount}</div>
                    <div class="stat-label">Hoy</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${uniqueEmails}</div>
                    <div class="stat-label">Emails √önicos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">${topInterest ? topInterest[1] : 0}</div>
                    <div class="stat-label">${topInterest ? topInterest[0] : 'Inter√©s'}</div>
                </div>
            `;
        }
        
        // Renderizar tabla
        function renderTable() {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            if (filteredData.length === 0) {
                document.getElementById('dataTable').style.display = 'none';
                document.getElementById('noData').style.display = 'block';
                return;
            }
            
            // Calcular √≠ndices para la p√°gina actual
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageData = filteredData.slice(startIndex, endIndex);
            
            pageData.forEach((item, index) => {
                const globalIndex = startIndex + index + 1;
                const row = document.createElement('tr');
                
                // Formatear mensaje para mostrar
                const shortMessage = item.mensaje 
                    ? (item.mensaje.length > 50 ? item.mensaje.substring(0, 50) + '...' : item.mensaje)
                    : 'No hay mensaje';
                
                row.innerHTML = `
                    <td>${globalIndex}</td>
                    <td class="date-cell">${item.fecha || 'N/A'}</td>
                    <td>${item.hora || 'N/A'}</td>
                    <td><strong>${item.nombre || 'N/A'}</strong></td>
                    <td class="email-cell" title="${item.email || ''}">${item.email || 'N/A'}</td>
                    <td>${item.telefono || 'N/A'}</td>
                    <td>${item.interes || 'No especificado'}</td>
                    <td>${item.presupuesto || 'No especificado'}</td>
                    <td class="message-cell" title="${item.mensaje || ''}">${shortMessage}</td>
                    <td>
                        <button class="btn btn-primary" style="padding: 5px 10px; font-size: 12px;" 
                                onclick="showDetail(${globalIndex - 1})">
                            üëÅÔ∏è Ver
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // Renderizar paginaci√≥n
        function renderPagination() {
            const pagination = document.getElementById('pagination');
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            
            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }
            
            let html = '';
            
            // Bot√≥n anterior
            html += `<button class="page-btn" ${currentPage === 1 ? 'disabled' : ''} 
                     onclick="changePage(${currentPage - 1})">¬´ Anterior</button>`;
            
            // N√∫meros de p√°gina
            const maxVisible = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisible / 2));
            let endPage = Math.min(totalPages, startPage + maxVisible - 1);
            
            if (endPage - startPage + 1 < maxVisible) {
                startPage = Math.max(1, endPage - maxVisible + 1);
            }
            
            for (let i = startPage; i <= endPage; i++) {
                html += `<button class="page-btn ${i === currentPage ? 'active' : ''}" 
                         onclick="changePage(${i})">${i}</button>`;
            }
            
            // Bot√≥n siguiente
            html += `<button class="page-btn" ${currentPage === totalPages ? 'disabled' : ''} 
                     onclick="changePage(${currentPage + 1})">Siguiente ¬ª</button>`;
            
            // Info de p√°gina
            html += `<span style="margin-left: 15px; color: #666;">
                       P√°gina ${currentPage} de ${totalPages} (${filteredData.length} registros)
                     </span>`;
            
            pagination.innerHTML = html;
        }
        
        // Cambiar p√°gina
        function changePage(page) {
            if (page < 1 || page > Math.ceil(filteredData.length / itemsPerPage)) return;
            currentPage = page;
            renderTable();
            renderPagination();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // Configurar b√∫squeda
        function setupSearch() {
            const searchInput = document.getElementById('searchInput');
            let searchTimeout;
            
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    const searchTerm = this.value.toLowerCase().trim();
                    
                    if (searchTerm === '') {
                        filteredData = [...allData];
                    } else {
                        filteredData = allData.filter(item => {
                            return (
                                (item.nombre && item.nombre.toLowerCase().includes(searchTerm)) ||
                                (item.email && item.email.toLowerCase().includes(searchTerm)) ||
                                (item.telefono && item.telefono.toLowerCase().includes(searchTerm)) ||
                                (item.mensaje && item.mensaje.toLowerCase().includes(searchTerm)) ||
                                (item.interes && item.interes.toLowerCase().includes(searchTerm))
                            );
                        });
                    }
                    
                    currentPage = 1;
                    renderTable();
                    renderPagination();
                }, 300);
            });
        }
        
        // Mostrar detalle de consulta
        function showDetail(index) {
            const item = filteredData[index];
            if (!item) return;
            
            const modalContent = document.getElementById('modalContent');
            
            modalContent.innerHTML = `
                <div class="detail-item">
                    <div class="detail-label">üìÖ Fecha y Hora</div>
                    <div class="detail-value">${item.fecha || 'N/A'} ${item.hora || ''}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">üë§ Nombre Completo</div>
                    <div class="detail-value">${item.nombre || 'N/A'}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">üìß Email</div>
                    <div class="detail-value">${item.email || 'N/A'}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">üì± Tel√©fono</div>
                    <div class="detail-value">${item.telefono || 'N/A'}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">üéØ Inter√©s</div>
                    <div class="detail-value">${item.interes || 'No especificado'}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">üí∞ Presupuesto</div>
                    <div class="detail-value">${item.presupuesto || 'No especificado'}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">üí¨ Mensaje Completo</div>
                    <div class="detail-value">${item.mensaje || 'No hay mensaje'}</div>
                </div>
                <div class="detail-item">
                    <div class="detail-label">üÜî Informaci√≥n T√©cnica</div>
                    <div class="detail-value" style="font-size: 12px; font-family: monospace;">
                        ID: ${item.id || 'N/A'}<br>
                        Timestamp: ${item.timestamp || 'N/A'}<br>
                        Source: ${item.source || 'formulario_web'}
                    </div>
                </div>
            `;
            
            document.getElementById('detailModal').style.display = 'flex';
        }
        
        // Cerrar modal
        function closeModal() {
            document.getElementById('detailModal').style.display = 'none';
        }
        
        // Mostrar modal de confirmaci√≥n
        function showClearModal() {
            document.getElementById('confirmMessage').innerHTML = `
                <p><strong>‚ö†Ô∏è ¬øEst√°s seguro de querer limpiar todos los datos?</strong></p>
                <p>Esta acci√≥n eliminar√° <strong>${allData.length} registros</strong> y no se puede deshacer.</p>
                <p style="color: #dc3545; margin-top: 10px;">
                    <strong>¬°ADVERTENCIA!</strong> Los datos se perder√°n permanentemente.
                </p>
            `;
            
            document.getElementById('confirmButton').onclick = clearAllData;
            document.getElementById('confirmModal').style.display = 'flex';
        }
        
        // Cerrar modal de confirmaci√≥n
        function closeConfirmModal() {
            document.getElementById('confirmModal').style.display = 'none';
        }
        
        // Limpiar todos los datos
        function clearAllData() {
            localStorage.removeItem('consultas_dante_propiedades');
            localStorage.removeItem('backup_consultas_dante');
            
            // Tambi√©n limpiar cualquier otro almacenamiento relacionado
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.includes('dante') || key.includes('consulta')) {
                    localStorage.removeItem(key);
                }
            }
            
            closeConfirmModal();
            alert('‚úÖ Todos los datos han sido eliminados.');
            loadData();
        }
        
        // Exportar a CSV
        function exportToCSV() {
            if (allData.length === 0) {
                alert('No hay datos para exportar');
                return;
            }
            
            const headers = ['Fecha', 'Hora', 'Nombre', 'Email', 'Tel√©fono', 'Inter√©s', 'Presupuesto', 'Mensaje', 'Timestamp'];
            const csvRows = [];
            
            // Encabezados
            csvRows.push(headers.join(','));
            
            // Datos
            allData.forEach(item => {
                const row = [
                    `"${(item.fecha || '').replace(/"/g, '""')}"`,
                    `"${(item.hora || '').replace(/"/g, '""')}"`,
                    `"${(item.nombre || '').replace(/"/g, '""')}"`,
                    `"${(item.email || '').replace(/"/g, '""')}"`,
                    `"${(item.telefono || '').replace(/"/g, '""')}"`,
                    `"${(item.interes || '').replace(/"/g, '""')}"`,
                    `"${(item.presupuesto || '').replace(/"/g, '""')}"`,
                    `"${(item.mensaje || '').replace(/"/g, '""').replace(/\n/g, ' ')}"`,
                    `"${(item.timestamp || '').replace(/"/g, '""')}"`
                ];
                csvRows.push(row.join(','));
            });
            
            const csvString = csvRows.join('\n');
            const blob = new Blob(['\ufeff' + csvString], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `consultas_dante_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert(`‚úÖ Exportados ${allData.length} registros a CSV`);
        }
        
        // Exportar a Excel (HTML table)
        function exportToExcel() {
            if (allData.length === 0) {
                alert('No hay datos para exportar');
                return;
            }
            
            // Crear tabla HTML
            let tableHtml = '<table border="1"><thead><tr>';
            const headers = ['#', 'Fecha', 'Hora', 'Nombre', 'Email', 'Tel√©fono', 'Inter√©s', 'Presupuesto', 'Mensaje'];
            headers.forEach(header => {
                tableHtml += `<th>${header}</th>`;
            });
            tableHtml += '</tr></thead><tbody>';
            
            allData.forEach((item, index) => {
                tableHtml += '<tr>';
                tableHtml += `<td>${index + 1}</td>`;
                tableHtml += `<td>${item.fecha || ''}</td>`;
                tableHtml += `<td>${item.hora || ''}</td>`;
                tableHtml += `<td>${item.nombre || ''}</td>`;
                tableHtml += `<td>${item.email || ''}</td>`;
                tableHtml += `<td>${item.telefono || ''}</td>`;
                tableHtml += `<td>${item.interes || ''}</td>`;
                tableHtml += `<td>${item.presupuesto || ''}</td>`;
                tableHtml += `<td>${(item.mensaje || '').replace(/\n/g, ' ')}</td>`;
                tableHtml += '</tr>';
            });
            
            tableHtml += '</tbody></table>';
            
            // Crear archivo HTML que Excel puede abrir
            const excelHtml = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>Consultas Dante Propiedades</title>
                    <style>
                        table { border-collapse: collapse; width: 100%; }
                        th { background: #232deb; color: white; padding: 10px; }
                        td { padding: 8px; border: 1px solid #ddd; }
                    </style>
                </head>
                <body>
                    <h1>Consultas Dante Propiedades</h1>
                    <p>Exportado: ${new Date().toLocaleString('es-AR')}</p>
                    <p>Total de registros: ${allData.length}</p>
                    ${tableHtml}
                </body>
                </html>
            `;
            
            const blob = new Blob([excelHtml], { type: 'application/vnd.ms-excel' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `consultas_dante_${new Date().toISOString().split('T')[0]}.xls`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert(`‚úÖ Exportados ${allData.length} registros a Excel (XLS)`);
        }
        
        // Refrescar datos
        function refreshData() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('dataTable').style.display = 'none';
            document.getElementById('noData').style.display = 'none';
            
            setTimeout(() => {
                loadData();
                alert('Datos actualizados correctamente');
            }, 500);
        }
        
        // Cerrar modales con ESC
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeModal();
                closeConfirmModal();
            }
        });
        
        // Cerrar modales haciendo clic fuera
        window.onclick = function(event) {
            const detailModal = document.getElementById('detailModal');
            const confirmModal = document.getElementById('confirmModal');
            
            if (event.target === detailModal) {
                closeModal();
            }
            if (event.target === confirmModal) {
                closeConfirmModal();
            }
        };
    </script>
</body>
</html>